<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Tool web ƒë·ªÉ t·∫°o v√† serialize JSON cho Unity AdData v·ªõi bidfloor configuration">
    <meta name="keywords" content="Unity, AdData, JSON, Serializer, MAX, Bidfloor">
    <meta name="author" content="AdData Tool">
    <title><%= title %></title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéØ</text></svg>">
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/dynamic.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üéØ AdData JSON Serializer Tool</h1>
            <p style="text-align: center; color: #666; margin-bottom: 30px;">
                Tool ƒë·ªÉ t·∫°o v√† serialize JSON cho AdData class t·ª´ Unity C#<br>
                <strong>C·∫•u tr√∫c m·ªõi: DefaultAdUnitData + BidfloorConfig (Interstitial, Rewarded, Banner)</strong><br>
                <span class="version-badge">Version <%= version %></span>
            </p>
        </header>

        <main>
            <form id="adDataForm" role="form" aria-label="AdData Configuration Form">
            <!-- PROJECT IDENTIFIER GROUP -->
            <section class="group-container" aria-labelledby="project-title">
                <h2 id="project-title" class="group-title">üè∑Ô∏è PROJECT IDENTIFIER</h2>
                <div class="group-description">ƒê·ªãnh danh project v√† qu·∫£n l√Ω d·ªØ li·ªáu</div>

                <div class="section">
                    <h3>üìã Project Information</h3>
                    <div class="form-group">
                        <label for="projectName">Project Name:</label>
                        <input type="text"
                               id="projectName"
                               name="projectName"
                               placeholder="Nh·∫≠p t√™n project (VD: MyGame_v1.0)"
                               onchange="loadProjectData()"
                               oninput="handleProjectNameInput()"
                               aria-describedby="project-help">
                        <small id="project-help" style="color: #6c757d; font-style: italic;">D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c l∆∞u t·ª± ƒë·ªông theo t√™n project</small>
                    </div>
                    
                    <!-- Script Management Section -->
                    <div class="script-management-section">
                        <div class="script-header">
                            <h3>üìú Scripts Management</h3>
                            <div class="script-controls">
                                <select id="currentScriptSelector" onchange="switchScript()">
                                    <option value="">Ch·ªçn script...</option>
                                </select>
                                <button type="button" class="btn btn-success btn-sm" onclick="showAddScriptModal()">‚ûï Th√™m Script</button>
                                <button type="button" class="btn btn-warning btn-sm" onclick="showEditScriptModal()" id="editScriptBtn" disabled>‚úèÔ∏è S·ª≠a Script</button>
                                <button type="button" class="btn btn-danger btn-sm" onclick="deleteCurrentScript()" id="deleteScriptBtn" disabled>üóëÔ∏è X√≥a Script</button>
                            </div>
                        </div>

                        <div class="current-script-info" id="currentScriptInfo" style="display: none;">
                            <div class="script-info-card">
                                <h4 id="currentScriptName">Script Name</h4>
                                <p><strong>Script ID:</strong> <span id="currentScriptId">-</span></p>
                                <p><strong>Tr·∫°ng th√°i:</strong> <span id="currentScriptStatus">Ch∆∞a c√≥ d·ªØ li·ªáu</span></p>
                            </div>
                        </div>
                    </div>

                    <div class="project-controls" role="group" aria-label="Project Management Controls">
                        <button type="button" class="btn btn-success" onclick="createNewProject()" aria-label="T·∫°o project m·ªõi">‚ûï T·∫°o Project M·ªõi</button>
                        <button type="button" class="btn btn-primary" onclick="saveCurrentProject()" aria-label="L∆∞u project hi·ªán t·∫°i">üíæ L∆∞u Project</button>
                        <button type="button" class="btn btn-primary" onclick="showProjectList()" aria-label="Xem danh s√°ch projects">üìÇ Load Project</button>
                        <button type="button" class="btn btn-danger" onclick="deleteCurrentProject()" id="deleteProjectBtn" aria-label="X√≥a project hi·ªán t·∫°i" style="display: none;">üóëÔ∏è X√≥a Project</button>
                        <button type="button" class="btn btn-primary" onclick="exportProject()" aria-label="Xu·∫•t project ra file">üì§ Export Project</button>
                        <button type="button" class="btn btn-primary" onclick="importProject()" id="importProjectBtn" aria-label="Nh·∫≠p project t·ª´ file">üì• Import Project</button>
                    </div>
                    
                    <!-- Project Status -->
                    <div id="projectStatus" class="project-status" style="display: none;">
                        <div class="status-info">
                            <span id="projectId" class="project-id"></span>
                            <span id="lastSaved" class="last-saved"></span>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- DEFAULT GROUP -->
            <div class="group-container">
                <h1 class="group-title">üéØ DEFAULT CONFIGURATION</h1>
                <div class="group-description">C·∫•u h√¨nh m·∫∑c ƒë·ªãnh cho c√°c lo·∫°i qu·∫£ng c√°o</div>

                <!-- DefaultAdUnitData Section -->
                <div class="section">
                    <h2>üì± Default Ad Unit Data</h2>
                    <div class="grid">
                        <div class="form-group">
                            <label for="interstitialId">Interstitial ID:</label>
                            <input type="text" id="interstitialId" name="interstitialId" placeholder="V√≠ d·ª•: a1b2c3d4e5f6g7h8" maxlength="16" oninput="validateAdId(this)" onblur="validateAdId(this)">
                            <small class="validation-message validation-info">Format: 16 k√Ω t·ª± (ch·ªØ th∆∞·ªùng a-z v√† s·ªë 0-9)</small>
                        </div>
                        <div class="form-group">
                            <label for="rewardedVideoId">Rewarded Video ID:</label>
                            <input type="text" id="rewardedVideoId" name="rewardedVideoId" placeholder="V√≠ d·ª•: a1b2c3d4e5f6g7h8" maxlength="16" oninput="validateAdId(this)" onblur="validateAdId(this)">
                            <small class="validation-message validation-info">Format: 16 k√Ω t·ª± (ch·ªØ th∆∞·ªùng a-z v√† s·ªë 0-9)</small>
                        </div>
                        <div class="form-group">
                            <label for="bannerId">Banner ID:</label>
                            <input type="text" id="bannerId" name="bannerId" placeholder="V√≠ d·ª•: a1b2c3d4e5f6g7h8" maxlength="16" oninput="validateAdId(this)" onblur="validateAdId(this)">
                            <small class="validation-message validation-info">Format: 16 k√Ω t·ª± (ch·ªØ th∆∞·ªùng a-z v√† s·ªë 0-9)</small>
                        </div>
                        <div class="form-group">
                            <label for="aoaId">AOA ID:</label>
                            <input type="text" id="aoaId" name="aoaId" placeholder="V√≠ d·ª•: a1b2c3d4e5f6g7h8" maxlength="16" oninput="validateAdId(this)" onblur="validateAdId(this)">
                            <small class="validation-message validation-info">Format: 16 k√Ω t·ª± (ch·ªØ th∆∞·ªùng a-z v√† s·ªë 0-9)</small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- BIDFLOOR GROUP -->
            <div class="group-container">
                <h1 class="group-title">üí∞ BIDFLOOR CONFIGURATION</h1>
                <div class="group-description">C·∫•u h√¨nh bidfloor cho c√°c lo·∫°i qu·∫£ng c√°o</div>

                <!-- BidfloorInterstitial Section -->
                <div class="section">
                    <h2>üé¨ Bidfloor Interstitial Config</h2>
                    <div class="form-group">
                        <label for="interstitialDefaultId">Default ID:</label>
                        <input type="text" id="interstitialDefaultId" name="interstitialDefaultId" placeholder="V√≠ d·ª•: a1b2c3d4e5f6g7h8" maxlength="16" oninput="validateAdId(this)" onblur="validateAdId(this)">
                        <small class="validation-message validation-info">Format: 16 k√Ω t·ª± (ch·ªØ th∆∞·ªùng a-z v√† s·ªë 0-9)</small>
                    </div>
                    <div class="form-group">
                        <label>Bidfloor IDs:</label>
                        <div id="interstitialBidfloorIds">
                            <div class="array-input">
                                <div class="array-input-row">
                                    <div class="array-input-field">
                                        <input type="text" placeholder="V√≠ d·ª•: a1b2c3d4e5f6g7h8" maxlength="16" oninput="validateAdId(this)" onblur="validateAdId(this)">
                                        <small class="validation-message validation-info">Format: 16 k√Ω t·ª± (ch·ªØ th∆∞·ªùng a-z v√† s·ªë 0-9)</small>
                                    </div>
                                    <button type="button" class="btn btn-add" onclick="addBidfloorId('interstitial', this)">Th√™m</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="grid">
                        <div class="form-group">
                            <label for="interstitialLoadCount">Bid Floor Load Count:</label>
                            <input type="number" id="interstitialLoadCount" name="interstitialLoadCount" value="3" min="1">
                        </div>
                        <div class="form-group">
                            <label for="interstitialAutoReloadInterval">Auto Reload Interval:</label>
                            <input type="number" id="interstitialAutoReloadInterval" name="interstitialAutoReloadInterval" value="99999" min="1">
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="interstitialAutoRetry" name="interstitialAutoRetry">
                        <label for="interstitialAutoRetry">Bid Floor Auto Retry</label>
                    </div>
                </div>

                <!-- BidfloorRewarded Section -->
                <div class="section">
                    <h2>üéÅ Bidfloor Rewarded Config</h2>
                    <div class="form-group">
                        <label for="rewardedDefaultId">Default ID:</label>
                        <input type="text" id="rewardedDefaultId" name="rewardedDefaultId" placeholder="V√≠ d·ª•: a1b2c3d4e5f6g7h8" maxlength="16" oninput="validateAdId(this)" onblur="validateAdId(this)">
                        <small class="validation-message validation-info">Format: 16 k√Ω t·ª± (ch·ªØ th∆∞·ªùng a-z v√† s·ªë 0-9)</small>
                    </div>
                    <div class="form-group">
                        <label>Bidfloor IDs:</label>
                        <div id="rewardedBidfloorIds">
                            <div class="array-input">
                                <div class="array-input-row">
                                    <div class="array-input-field">
                                        <input type="text" placeholder="V√≠ d·ª•: a1b2c3d4e5f6g7h8" maxlength="16" oninput="validateAdId(this)" onblur="validateAdId(this)">
                                        <small class="validation-message validation-info">Format: 16 k√Ω t·ª± (ch·ªØ th∆∞·ªùng a-z v√† s·ªë 0-9)</small>
                                    </div>
                                    <button type="button" class="btn btn-add" onclick="addBidfloorId('rewarded', this)">Th√™m</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="grid">
                        <div class="form-group">
                            <label for="rewardedLoadCount">Bid Floor Load Count:</label>
                            <input type="number" id="rewardedLoadCount" name="rewardedLoadCount" value="3" min="1">
                        </div>
                        <div class="form-group">
                            <label for="rewardedAutoReloadInterval">Auto Reload Interval:</label>
                            <input type="number" id="rewardedAutoReloadInterval" name="rewardedAutoReloadInterval" value="99999" min="1">
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="rewardedAutoRetry" name="rewardedAutoRetry">
                        <label for="rewardedAutoRetry">Bid Floor Auto Retry</label>
                    </div>
                </div>

                <!-- BidfloorBanner Section -->
                <div class="section">
                    <h2>üè∑Ô∏è Bidfloor Banner Config</h2>
                    <div class="form-group">
                        <label for="bidfloorBanner">Bidfloor Banner ID:</label>
                        <input type="text" id="bidfloorBanner" name="bidfloorBanner" placeholder="V√≠ d·ª•: a1b2c3d4e5f6g7h8" maxlength="16" oninput="validateAdId(this)" onblur="validateAdId(this)">
                        <small class="validation-message validation-info">Format: 16 k√Ω t·ª± (ch·ªØ th∆∞·ªùng a-z v√† s·ªë 0-9)</small>
                    </div>
                </div>
            </div>
        </form>

        <div class="button-group">
            <button type="button" class="btn btn-primary" onclick="validateEntireForm()">‚úÖ Ki·ªÉm tra d·ªØ li·ªáu</button>
            <button type="button" class="btn btn-primary" onclick="generateJSON()">üîÑ T·∫°o JSON</button>
            <button type="button" class="btn btn-primary" onclick="copyToClipboard()">üìã Copy JSON</button>
            <button type="button" class="btn btn-primary" onclick="downloadJSON()">üíæ T·∫£i xu·ªëng JSON</button>
            <button type="button" class="btn btn-primary" onclick="showImportDataModal()" id="importDataBtn">üì• Import JSON Data</button>
        </div>

        <div class="output-section">
            <h2>üìÑ JSON Output</h2>
            <textarea id="jsonOutput" readonly placeholder="JSON s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ·ªü ƒë√¢y..."></textarea>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>ƒêang x·ª≠ l√Ω...</p>
        </div>
    </div>

    <!-- Include modals and scripts -->
    <%- include('partials/modals') %>
    
    <script src="/js/config.js"></script>
    <script src="/js/api.js"></script>
    <script src="/js/validation.js"></script>
    <script src="/js/ui.js"></script>
    <script src="/js/app.js"></script>
</body>
</html>
